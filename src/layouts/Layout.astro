---
export interface Props {
  title: string;
  canonical?: string;
  description?: string;
  keywords?: string;
  author?: string;
  ogImage?: string;
  favicon?: string;
}

import { getCollection } from "astro:content";

const storeData = await getCollection("store");
const store = storeData[0]?.data || {};

const { title, canonical, description, keywords, author, ogImage, favicon } =
  Astro.props;
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- SEO Meta Tags -->
    <title>{title}</title>
    {description && <meta name="description" content={description} />}
    {keywords && <meta name="keywords" content={keywords} />}
    {author && <meta name="author" content={author} />}
    <meta name="generator" content={Astro.generator} />

    <!-- Canonical URL -->
    {canonical && <link rel="canonical" href={canonical} />}

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content={title} />
    {description && <meta property="og:description" content={description} />}
    <meta property="og:type" content="website" />
    {canonical && <meta property="og:url" content={canonical} />}
    {ogImage && <meta property="og:image" content={ogImage} />}

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    {description && <meta name="twitter:description" content={description} />}
    {ogImage && <meta name="twitter:image" content={ogImage} />}

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      href={favicon || `${import.meta.env.BASE_URL}favicon.svg`}
    />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous"
    />

    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />

    <!-- Head Scripts from Store Settings -->
    {
      store?.settings?.meta?.head_scripts?.map(
        (script: { url: string; defer: boolean }) => (
          <script
            defer={script.defer}
            src={script.url}
            type="text/javascript"
          />
        )
      )
    }
  </head>
  <body>
    <slot />

    <!-- Bootstrap JavaScript Bundle with Popper -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
      crossorigin="anonymous"
    >
    </script>
  </body>
</html>
