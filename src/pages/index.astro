---
import Layout from "../layouts/Layout.astro";
import data from "../../public/data.json";
import SimpleNavbar from "../components/simpleNavbar";
import SimpleFooter from "../components/simpleFooter";
import CardProduct from "../components/products/cardProduct";
import PageCards from "../components/markket/pages.cards.astro";

import { getCollection } from "astro:content";

const storeData = await getCollection("store");
const store = storeData[0]?.data || {};
const storeName = store.title || "Markkët Express";
const storeDescription =
  store.Description ||
  "Plantilla y tienda compatible con Markkët para prestar servicios y vender productos. Ejemplos, tutoriales y documentación en español.";
const storeLogo = store.Logo?.url || "";
const storeCover = store.Cover?.url || "";
const storeSEO = store.SEO || {};
const pages = (await getCollection("pages"))?.splice(0, 2);
---

<Layout
  title={storeSEO.metaTitle || storeName}
  description={storeSEO.metaDescription || storeDescription}
  keywords={storeSEO.metaKeywords ||
    "markket express, plantilla ecommerce, tienda online, productos, servicios, español, astro, bootstrap"}
  author={storeSEO.metaAuthor || "Markkët Express"}
  ogImage={store.Logo?.url || store.Cover?.url}
  favicon={store.Favicon?.url}
  canonical={storeSEO.metaUrl}
>
  <!-- Navigation -->
  <SimpleNavbar storeName={storeName} storeLogo={storeLogo} />

  <main>
    <!-- Hero Section Simple -->
    <section
      class="py-5"
      style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"
    >
      <div class="container">
        <div class="row justify-content-center text-center">
          <div class="col-lg-8">
            <div class="text-white">
              {
                storeLogo && (
                  <img
                    src={storeLogo}
                    alt={`${storeName} Logo`}
                    class="mb-4"
                    style="height: 60px; object-fit: contain; filter: brightness(0) invert(1);"
                  />
                )
              }
              <h1 class="display-4 fw-bold mb-3">{storeName}</h1>
              <p class="lead mb-4">{storeDescription}</p>
              <div class="d-flex justify-content-center gap-3 flex-wrap">
                <a href="/servicios" class="btn btn-light btn-lg">
                  <i class="bi bi-briefcase me-2"></i>
                  Ver Servicios
                </a>
                <a href="/about" class="btn btn-outline-light btn-lg">
                  <i class="bi bi-info-circle me-2"></i>
                  Conocer Más
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="container my-5">
      <!-- Featured Products Section -->
      <section class="my-5">
        <div class="row">
          <div class="col-12 text-center mb-5">
            <h2 class="display-6 fw-bold">Productos Destacados</h2>
            <p class="lead text-muted">
              Descubre nuestros artículos más populares
            </p>
          </div>
        </div>
        <div class="row">
          {
            data.products.slice(0, 4).map((product) => (
              <div class="col-md-6 col-lg-3 mb-4">
                <CardProduct
                  thumb_src={product.thumb_src}
                  thumb_alt={product.thumb_alt}
                  color={product.color}
                  colors={product.colors || []}
                  title={product.title}
                  description={product.description}
                  price={product.price}
                  position="center"
                />
              </div>
            ))
          }
        </div>
        <div class="text-center mt-4">
          <a class="btn btn-primary btn-lg" href="/servicios">
            Ver Todos los Servicios
            <i class="bi bi-arrow-right ms-2"></i>
          </a>
        </div>
      </section>

      <section class="my-5">
        <div class="row justify-content-center">
          <div class="col-lg-8 text-center">
            <div class="bg-light rounded-3 p-5">
              <h3 class="fw-bold mb-3">Conoce a {storeName}</h3>
              <p class="text-muted mb-4">{storeDescription}</p>
              <div class="row">
                <div class="col-md-4 mb-3">
                  <i class="bi bi-shield-check text-primary fs-1 mb-2"></i>
                  <h5>Confiable</h5>
                  <small class="text-muted">Seguro y confiable</small>
                </div>
                <div class="col-md-4 mb-3">
                  <i class="bi bi-truck text-primary fs-1 mb-2"></i>
                  <h5>Envío Rápido</h5>
                  <small class="text-muted">Entrega rápida</small>
                </div>
                <div class="col-md-4 mb-3">
                  <i class="bi bi-heart text-primary fs-1 mb-2"></i>
                  <h5>Calidad</h5>
                  <small class="text-muted">Productos premium</small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="my-5">
        <div class="row">
          <div class="col-12 text-center mb-4">
            <h2 class="display-6 fw-bold">Acerca de Nosostros</h2>
          </div>
        </div>
        <div class="row">
          <PageCards pages={pages} />
        </div>
      </section>
    </div>
  </main>

  <!-- Footer -->
  <SimpleFooter store={store} />
</Layout>
