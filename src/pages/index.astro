---
import Layout from "../layouts/Layout.astro";
import data from "../../public/data.json";
import "../../assets/scss/astro-ecommerce.scss";
import ComplexNavbar from "../components/complexNavbar";
import ComplexFooter from "../components/complexFooter";
import CardProduct from "../components/products/cardProduct";
import CardCategory from "../components/products/cardCategory";
import TestimonialsFade from "../components/promo/testimonialsFade";
import IncentiveCols from "../components/incentives/incentiveCols";

import { getCollection } from "astro:content";

const storeData = await getCollection("store");
const store = storeData[0]?.data || {};
const storeName = store.title || "Markkët Express";
const storeDescription =
  store.Description ||
  "Plantilla y tienda compatible con Markkët para prestar servicios y vender productos. Ejemplos, tutoriales y documentación en español.";
const storeLogo = store.Logo?.url || "";
const storeCover = store.Cover?.url || "";
const storeSEO = store.SEO || {};
---

<script>
  function toggleHeart(e) {
    e.target.classList.toggle("fas");
    e.target.classList.toggle("far");
    e.target.classList.toggle("text-danger");
  }

  document.getElementById("heart1")?.addEventListener("click", toggleHeart);
</script>

<Layout
  title={storeSEO.metaTitle || storeName}
  description={storeSEO.metaDescription || storeDescription}
  keywords={storeSEO.metaKeywords ||
    "markket express, plantilla ecommerce, tienda online, productos, servicios, español, astro, bootstrap"}
  author={storeSEO.metaAuthor || "Markkët Express"}
  ogImage={store.Logo?.url || store.Cover?.url}
  favicon={store.Favicon?.url}
  canonical={storeSEO.metaUrl}
>
  <main>
    <!-- Navigation -->
    <ComplexNavbar />

    <!-- Hero Section with Store Information -->
    <section
      class="py-7"
      style={storeCover
        ? `background-image: url('${storeCover}'); background-size: cover; background-position: center;`
        : "background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"}
    >
      <div class="container">
        <div class="row justify-content-center text-center">
          <div class="col-lg-8">
            <div class="bg-white bg-opacity-90 rounded-3 p-5 shadow">
              {
                storeLogo && (
                  <img
                    src={storeLogo}
                    alt={`${storeName} Logo`}
                    class="mb-4"
                    style="height: 80px; object-fit: contain;"
                  />
                )
              }
              <h1 class="display-4 fw-bold text-dark mb-3">{storeName}</h1>
              <p class="lead text-muted mb-4">{storeDescription}</p>
              <div class="d-flex justify-content-center gap-3">
                <button class="btn btn-primary btn-lg">
                  <i class="bi bi-bag-fill me-2"></i>
                  Comprar Ahora
                </button>
                <button class="btn btn-outline-primary btn-lg">
                  <i class="bi bi-info-circle me-2"></i>
                  Conocer Más
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="container mt-5">
      <!-- Featured Products Section -->
      <section class="my-5">
        <div class="row">
          <div class="col-12 text-center mb-5">
            <h2 class="display-5 fw-bold">Productos Destacados</h2>
            <p class="lead text-muted">
              Descubre nuestros artículos más populares
            </p>
          </div>
        </div>
        <div class="row">
          {
            data.products.slice(0, 4).map((product) => (
              <div class="col-md-6 col-lg-3 mb-4">
                <CardProduct
                  thumb_src={product.thumb_src}
                  thumb_alt={product.thumb_alt}
                  color={product.color}
                  colors={product.colors || []}
                  title={product.title}
                  description={product.description}
                  price={product.price}
                  position="center"
                />
              </div>
            ))
          }
        </div>
      </section>

      <!-- Shop by Category Section -->
      <section class="my-5">
        <div class="row">
          <div class="col-12 text-center mb-5">
            <h2 class="display-5 fw-bold">Comprar por Categoría</h2>
            <p class="lead text-muted">Encuentra exactamente lo que buscas</p>
          </div>
        </div>
        <div class="row">
          {
            data.categories.slice(0, 4).map((category) => (
              <div class="col-md-6 col-lg-3 mb-4">
                <CardCategory
                  classList="h-100"
                  cta=""
                  thumb_src={category.thumb_src}
                  title={category.title}
                  collection={category.collection}
                />
              </div>
            ))
          }
        </div>
        <div class="text-center mt-4">
          <a class="btn btn-outline-primary btn-lg" href="#">
            Ver Todas las Categorías
            <i class="bi bi-arrow-right ms-2"></i>
          </a>
        </div>
      </section>

      <!-- Testimonials Section -->
      <section class="my-5">
        <TestimonialsFade
          pageHeaderBgImg={"https://images.unsplash.com/photo-1534802046520-4f27db7f3ae5?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2729&q=80"}
          pageHeaderMinVh="50vh"
        />
      </section>

      <!-- Features/Incentives Section -->
      <section class="my-5">
        <div class="row">
          <div class="col-12 text-center mb-5">
            <h2 class="display-5 fw-bold">¿Por qué elegir {storeName}?</h2>
            <p class="lead text-muted">
              Estamos comprometidos a brindar la mejor experiencia de compra
            </p>
          </div>
        </div>
        <IncentiveCols />
      </section>

      <!-- Store Information Card -->
      <section class="my-5">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            <div class="card shadow-lg border-0">
              <div class="card-body p-5 text-center">
                <h3 class="card-title fw-bold mb-3">Acerca de {storeName}</h3>
                <p class="card-text text-muted mb-4">{storeDescription}</p>
                <div class="row text-center">
                  <div class="col-md-4 mb-3">
                    <div class="d-flex flex-column align-items-center">
                      <i class="bi bi-shield-check text-primary fs-1 mb-2"></i>
                      <h5>Confiable</h5>
                      <small class="text-muted">Seguro y confiable</small>
                    </div>
                  </div>
                  <div class="col-md-4 mb-3">
                    <div class="d-flex flex-column align-items-center">
                      <i class="bi bi-truck text-primary fs-1 mb-2"></i>
                      <h5>Envío Rápido</h5>
                      <small class="text-muted">Entrega rápida</small>
                    </div>
                  </div>
                  <div class="col-md-4 mb-3">
                    <div class="d-flex flex-column align-items-center">
                      <i class="bi bi-heart text-primary fs-1 mb-2"></i>
                      <h5>Calidad</h5>
                      <small class="text-muted">Productos premium</small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Footer -->
    <ComplexFooter />
  </main>
</Layout>
