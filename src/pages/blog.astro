---
import Layout from "../layouts/Layout.astro";
import SimpleNavbar from "../components/simpleNavbar";
import SimpleFooter from "../components/simpleFooter";

import { getCollection } from "astro:content";

const storeData = await getCollection("store");
const store = storeData[0]?.data || {};
const storeName = store.title || "Markkët Express";
const storeDescription =
  store.Description ||
  "Plantilla y tienda compatible con Markkët para prestar servicios y vender productos.";
const storeLogo = store.Logo?.url || "";
const storeSEO = store.SEO || {};

// Sample blog posts - later this would come from your CMS
const blogPosts = [
  {
    id: 1,
    title: "Cómo elegir el producto perfecto para ti",
    excerpt: "Descubre los factores clave que debes considerar al elegir productos que se adapten a tus necesidades y estilo de vida.",
    image: "https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
    author: "Equipo Markkët",
    date: "2024-10-01",
    category: "Guías",
    readTime: "5 min"
  },
  {
    id: 2,
    title: "Tendencias 2024: Lo que está de moda",
    excerpt: "Explora las últimas tendencias y descubre qué estilos dominarán este año en el mundo de la moda y los productos.",
    image: "https://images.unsplash.com/photo-1441986300917-64674bd600d8?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
    author: "María González",
    date: "2024-09-28",
    category: "Tendencias",
    readTime: "7 min"
  },
  {
    id: 3,
    title: "Cuidado y mantenimiento de tus productos",
    excerpt: "Aprende las mejores prácticas para mantener tus productos en perfecto estado y prolongar su vida útil.",
    image: "https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
    author: "Carlos Rodríguez",
    date: "2024-09-25",
    category: "Tips",
    readTime: "6 min"
  }
];
---

<Layout
  title={`Blog - ${storeName}`}
  description={`Lee nuestros últimos artículos y consejos en el blog de ${storeName}.`}
  keywords="blog, artículos, consejos, guías, tendencias, noticias"
  author={storeSEO.metaAuthor || "Markkët Express"}
  ogImage={store.Logo?.url || store.Cover?.url}
  favicon={store.Favicon?.url}
>
  <!-- Navigation -->
  <SimpleNavbar storeName={storeName} storeLogo={storeLogo} />

  <main>
    <!-- Hero Section -->
    <section class="py-5 bg-light">
      <div class="container">
        <div class="row justify-content-center text-center">
          <div class="col-lg-8">
            <h1 class="display-4 fw-bold mb-3">Blog de {storeName}</h1>
            <p class="lead text-muted">
              Descubre consejos, tendencias y noticias del mundo de nuestros productos
            </p>
          </div>
        </div>
      </div>
    </section>

    <div class="container my-5">
      <!-- Featured Post -->
      <section class="mb-5">
        <div class="row align-items-center">
          <div class="col-lg-6">
            <img
              src={blogPosts[0].image}
              alt={blogPosts[0].title}
              class="img-fluid rounded shadow"
            />
          </div>
          <div class="col-lg-6">
            <div class="badge bg-primary mb-3">{blogPosts[0].category}</div>
            <h2 class="fw-bold mb-3">{blogPosts[0].title}</h2>
            <p class="text-muted mb-4">{blogPosts[0].excerpt}</p>
            <div class="d-flex align-items-center text-muted small mb-3">
              <i class="bi bi-person-circle me-2"></i>
              <span class="me-3">{blogPosts[0].author}</span>
              <i class="bi bi-calendar3 me-2"></i>
              <span class="me-3">{blogPosts[0].date}</span>
              <i class="bi bi-clock me-2"></i>
              <span>{blogPosts[0].readTime}</span>
            </div>
            <a href={`/blog/${blogPosts[0].id}`} class="btn btn-primary">
              Leer Artículo
              <i class="bi bi-arrow-right ms-2"></i>
            </a>
          </div>
        </div>
      </section>

      <!-- Blog Posts Grid -->
      <section class="mb-5">
        <div class="row align-items-center mb-4">
          <div class="col-md-6">
            <h3 class="fw-bold mb-0">Últimos Artículos</h3>
          </div>
          <div class="col-md-6 text-md-end">
            <div class="d-flex gap-2 justify-content-md-end flex-wrap">
              <button class="btn btn-outline-primary btn-sm active">Todos</button>
              <button class="btn btn-outline-primary btn-sm">Guías</button>
              <button class="btn btn-outline-primary btn-sm">Tendencias</button>
              <button class="btn btn-outline-primary btn-sm">Tips</button>
            </div>
          </div>
        </div>

        <div class="row">
          {
            blogPosts.slice(1).map((post) => (
              <div class="col-md-6 col-lg-4 mb-4">
                <article class="card border-0 shadow-sm h-100">
                  <img
                    src={post.image}
                    alt={post.title}
                    class="card-img-top"
                    style="height: 200px; object-fit: cover;"
                  />
                  <div class="card-body d-flex flex-column">
                    <div class="mb-3">
                      <span class="badge bg-primary">{post.category}</span>
                    </div>
                    <h5 class="card-title fw-bold">{post.title}</h5>
                    <p class="card-text text-muted flex-grow-1">{post.excerpt}</p>
                    <div class="d-flex align-items-center text-muted small mb-3">
                      <i class="bi bi-person-circle me-2"></i>
                      <span class="me-3">{post.author}</span>
                      <i class="bi bi-clock me-2"></i>
                      <span>{post.readTime}</span>
                    </div>
                    <a href={`/blog/${post.id}`} class="btn btn-outline-primary">
                      Leer Más
                    </a>
                  </div>
                </article>
              </div>
            ))
          }
        </div>
      </section>

      <!-- Newsletter Subscription -->
      <section class="my-5">
        <div class="bg-primary text-white rounded-3 p-5 text-center">
          <h3 class="fw-bold mb-3">¿No te quieres perder nada?</h3>
          <p class="mb-4">
            Suscríbete a nuestro boletín y recibe los últimos artículos directamente en tu inbox
          </p>
          <div class="row justify-content-center">
            <div class="col-md-6">
              <div class="input-group">
                <input type="email" class="form-control" placeholder="Tu email">
                <button class="btn btn-light" type="button">
                  <i class="bi bi-envelope me-1"></i>
                  Suscribirse
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Categories -->
      <section class="my-5">
        <div class="text-center mb-4">
          <h3 class="fw-bold">Explora por Categorías</h3>
        </div>
        <div class="row">
          <div class="col-md-3 mb-3">
            <div class="card border-0 bg-light text-center p-4">
              <i class="bi bi-book text-primary fs-1 mb-3"></i>
              <h5 class="fw-bold">Guías</h5>
              <p class="text-muted small mb-3">Consejos prácticos y tutoriales</p>
              <a href="#" class="btn btn-sm btn-outline-primary">Ver Guías</a>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card border-0 bg-light text-center p-4">
              <i class="bi bi-trending-up text-primary fs-1 mb-3"></i>
              <h5 class="fw-bold">Tendencias</h5>
              <p class="text-muted small mb-3">Lo último en moda y estilo</p>
              <a href="#" class="btn btn-sm btn-outline-primary">Ver Tendencias</a>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card border-0 bg-light text-center p-4">
              <i class="bi bi-lightbulb text-primary fs-1 mb-3"></i>
              <h5 class="fw-bold">Tips</h5>
              <p class="text-muted small mb-3">Consejos útiles y trucos</p>
              <a href="#" class="btn btn-sm btn-outline-primary">Ver Tips</a>
            </div>
          </div>
          <div class="col-md-3 mb-3">
            <div class="card border-0 bg-light text-center p-4">
              <i class="bi bi-newspaper text-primary fs-1 mb-3"></i>
              <h5 class="fw-bold">Noticias</h5>
              <p class="text-muted small mb-3">Últimas novedades</p>
              <a href="#" class="btn btn-sm btn-outline-primary">Ver Noticias</a>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Footer -->
  <SimpleFooter store={store} />
</Layout>

<script>
  // Simple filter functionality
  document.addEventListener('DOMContentLoaded', function() {
    const filterButtons = document.querySelectorAll('.btn-outline-primary');

    filterButtons.forEach(button => {
      button.addEventListener('click', function() {
        // Remove active class from all buttons in the same group
        const parentContainer = this.closest('.d-flex');
        if (parentContainer) {
          const siblingButtons = parentContainer.querySelectorAll('.btn-outline-primary');
          siblingButtons.forEach(btn => btn.classList.remove('active'));
          // Add active class to clicked button
          this.classList.add('active');
        }
      });
    });
  });
</script>